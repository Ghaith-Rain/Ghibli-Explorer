<div class="min-h-screen bg-gradient-to-br from-blue-50 via-pink-50 to-purple-50 py-8">
      <div class="container mx-auto px-4">
        <!-- Back Button -->
        <a 
          routerLink="/films" 
          class="inline-flex items-center text-blue-600 hover:text-blue-800 mb-6 transition-colors"
        >
          ← Back to Films
        </a>

        <!-- Loading State -->
        <div *ngIf="loading()" class="text-center py-12">
          <div class="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-pink-500"></div>
          <p class="mt-4 text-slate-600">Loading film details...</p>
        </div>

        <!-- Error State -->
        <div *ngIf="error()" class="max-w-md mx-auto bg-red-50 border border-red-200 rounded-lg p-6 text-center">
          <p class="text-red-700">{{ error() }}</p>
          <a routerLink="/films" class="mt-4 inline-block px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors">
            Back to Films
          </a>
        </div>

        <!-- Film Detail -->
        <div *ngIf="film() && !loading() && !error()" class="max-w-4xl mx-auto">
          <!-- Film Header -->
          <div class="bg-white rounded-lg shadow-lg p-8 mb-6 border-2 border-pink-100">
            <div class="flex justify-between items-start mb-4">
              <div>
                <h1 class="text-3xl md:text-4xl font-bold text-slate-800 mb-2">
                  {{ film()!.title }}
                </h1>
                <p class="text-lg text-slate-500 italic mb-1">{{ film()!.original_title }}</p>
                <p class="text-slate-500">{{ film()!.original_title_romanised }}</p>
              </div>
              <button
                (click)="toggleFavorite()"
                class="text-3xl hover:scale-110 transition-transform"
                [class.text-red-500]="isFavorite()"
                [class.text-gray-300]="!isFavorite()"
              >
                {{ isFavorite() ? '♥' : '♡' }}
              </button>
            </div>

            <!-- Film Details Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
              <div>
                <span class="font-semibold text-slate-700">Director:</span>
                <span class="ml-2 text-slate-600">{{ film()!.director }}</span>
              </div>
              <div>
                <span class="font-semibold text-slate-700">Producer:</span>
                <span class="ml-2 text-slate-600">{{ film()!.producer }}</span>
              </div>
              <div>
                <span class="font-semibold text-slate-700">Release Year:</span>
                <span class="ml-2 text-slate-600">{{ film()!.release_date }}</span>
              </div>
              <div>
                <span class="font-semibold text-slate-700">Running Time:</span>
                <span class="ml-2 text-slate-600">{{ film()!.running_time }} minutes</span>
              </div>
              <div>
                <span class="font-semibold text-slate-700">RT Score:</span>
                <span class="ml-2 text-slate-600 font-semibold">{{ film()!.rt_score }}/100</span>
              </div>
            </div>

            <!-- Description -->
            <div class="border-t border-slate-200 pt-6">
              <h2 class="text-xl font-semibold text-slate-800 mb-3">Description</h2>
              <p class="text-slate-600 leading-relaxed">{{ film()!.description }}</p>
            </div>
          </div>

          <!-- Film Review Form -->
          <div class="bg-white rounded-lg shadow-lg p-6 mb-6 border-2 border-blue-100">
            <h2 class="text-2xl font-semibold text-slate-800 mb-4">Write a Review</h2>
            <form [formGroup]="reviewForm" (ngSubmit)="addReview()">
              <!-- Star Rating -->
              <div class="mb-6">
                <label class="block text-sm font-medium text-slate-700 mb-3">
                  Rating * <span class="text-slate-500">(Select 1-5 stars)</span>
                </label>
                <div class="flex gap-2">
                  <button
                    *ngFor="let star of [1, 2, 3, 4, 5]"
                    type="button"
                    (click)="setRating(star)"
                    class="text-4xl transition-all hover:scale-110"
                    [class.text-yellow-400]="star <= (reviewForm.get('rating')?.value || 0)"
                    [class.text-gray-300]="star > (reviewForm.get('rating')?.value || 0)"
                  >
                    {{ star <= (reviewForm.get('rating')?.value || 0) ? '★' : '☆' }}
                  </button>
                </div>
                <div *ngIf="reviewForm.get('rating')?.invalid && reviewForm.get('rating')?.touched" class="mt-2">
                  <p class="text-sm text-red-600">Please select a rating</p>
                </div>
              </div>

              <!-- Review Title -->
              <div class="mb-4">
                <label for="title" class="block text-sm font-medium text-slate-700 mb-2">
                  Review Title *
                </label>
                <input
                  id="title"
                  type="text"
                  formControlName="title"
                  class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                  [class.border-red-500]="reviewForm.get('title')?.invalid && reviewForm.get('title')?.touched"
                  placeholder="Give your review a catchy title..."
                />
                <div *ngIf="reviewForm.get('title')?.invalid && reviewForm.get('title')?.touched" class="mt-2">
                  <p *ngIf="reviewForm.get('title')?.errors?.['required']" class="text-sm text-red-600">
                    Title is required
                  </p>
                  <p *ngIf="reviewForm.get('title')?.errors?.['minlength']" class="text-sm text-red-600">
                    Title must be at least 5 characters
                  </p>
                  <p *ngIf="reviewForm.get('title')?.errors?.['maxlength']" class="text-sm text-red-600">
                    Title must not exceed 50 characters
                  </p>
                </div>
              </div>

              <!-- Review Text -->
              <div class="mb-4">
                <label for="reviewText" class="block text-sm font-medium text-slate-700 mb-2">
                  Review *
                </label>
                <textarea
                  id="reviewText"
                  formControlName="reviewText"
                  rows="5"
                  class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                  [class.border-red-500]="reviewForm.get('reviewText')?.invalid && reviewForm.get('reviewText')?.touched"
                  placeholder="Write your detailed review here..."
                ></textarea>
                <div class="flex justify-between items-center mt-1">
                  <div *ngIf="reviewForm.get('reviewText')?.invalid && reviewForm.get('reviewText')?.touched">
                    <p *ngIf="reviewForm.get('reviewText')?.errors?.['required']" class="text-sm text-red-600">
                      Review text is required
                    </p>
                    <p *ngIf="reviewForm.get('reviewText')?.errors?.['minlength']" class="text-sm text-red-600">
                      Review must be at least 50 characters
                    </p>
                    <p *ngIf="reviewForm.get('reviewText')?.errors?.['maxlength']" class="text-sm text-red-600">
                      Review must not exceed 500 characters
                    </p>
                    <p *ngIf="reviewForm.get('reviewText')?.errors?.['spoilerWarning']" class="text-sm text-red-600">
                      If marked as spoiler, review must contain "spoiler" warning
                    </p>
                  </div>
                  <span class="text-xs text-slate-500">
                    {{ reviewForm.get('reviewText')?.value?.length || 0 }}/500
                  </span>
                </div>
              </div>

              <!-- Mood Selection -->
              <div class="mb-4">
                <label for="mood" class="block text-sm font-medium text-slate-700 mb-2">
                  Mood/Category *
                </label>
                <select
                  id="mood"
                  formControlName="mood"
                  class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                  [class.border-red-500]="reviewForm.get('mood')?.invalid && reviewForm.get('mood')?.touched"
                >
                  <option value="">Select a mood...</option>
                  <option value="Heartwarming">Heartwarming</option>
                  <option value="Adventurous">Adventurous</option>
                  <option value="Emotional">Emotional</option>
                  <option value="Magical">Magical</option>
                  <option value="Nostalgic">Nostalgic</option>
                  <option value="Thought-provoking">Thought-provoking</option>
                  <option value="Whimsical">Whimsical</option>
                </select>
                <div *ngIf="reviewForm.get('mood')?.invalid && reviewForm.get('mood')?.touched" class="mt-2">
                  <p class="text-sm text-red-600">Please select a mood</p>
                </div>
              </div>

              <!-- Spoiler Checkbox -->
              <div class="mb-4">
                <label class="flex items-center cursor-pointer">
                  <input
                    type="checkbox"
                    formControlName="isSpoiler"
                    class="w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"
                  />
                  <span class="ml-2 text-sm text-slate-700">This review contains spoilers</span>
                </label>
              </div>

              <!-- Date Watched (Optional) -->
              <div class="mb-6">
                <label for="dateWatched" class="block text-sm font-medium text-slate-700 mb-2">
                  Date Watched <span class="text-slate-500">(Optional)</span>
                </label>
                <input
                  id="dateWatched"
                  type="date"
                  formControlName="dateWatched"
                  class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                  [max]="today"
                />
              </div>

              <button
                type="submit"
                [disabled]="reviewForm.invalid"
                class="w-full px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed font-semibold"
              >
                Submit Review
              </button>
            </form>
          </div>

          <!-- Display Reviews -->
          <div *ngIf="filmReviews().length > 0" class="bg-white rounded-lg shadow-lg p-6 border-2 border-purple-100">
            <h2 class="text-2xl font-semibold text-slate-800 mb-4">Your Reviews</h2>
            <div class="space-y-6">
              <div 
                *ngFor="let review of filmReviews()" 
                class="p-6 bg-purple-50 rounded-lg border border-purple-200"
              >
                <!-- Star Rating Display -->
                <div class="flex items-center gap-4 mb-3">
                  <div class="text-2xl">
                    <span *ngFor="let star of [1, 2, 3, 4, 5]" [class.text-yellow-400]="star <= review.rating" [class.text-gray-300]="star > review.rating">
                      {{ star <= review.rating ? '★' : '☆' }}
                    </span>
                  </div>
                  <span *ngIf="review.isSpoiler" class="px-2 py-1 bg-red-100 text-red-700 text-xs rounded-full font-semibold">
                    SPOILER
                  </span>
                  <span class="px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded-full">
                    {{ review.mood }}
                  </span>
                </div>
                
                <!-- Review Title -->
                <h3 class="text-lg font-semibold text-slate-800 mb-2">{{ review.title }}</h3>
                
                <!-- Review Text -->
                <p class="text-slate-700 mb-3 leading-relaxed">{{ review.reviewText }}</p>
                
                <!-- Metadata -->
                <div class="flex justify-between items-center text-xs text-slate-500 border-t border-purple-200 pt-3">
                  <div class="space-x-4">
                    <span>Posted: {{ review.timestamp | date:'medium' }}</span>
                    <span *ngIf="review.dateWatched">Watched: {{ review.dateWatched | date:'shortDate' }}</span>
                  </div>
                  <button
                    (click)="deleteReview(review)"
                    class="text-red-600 hover:text-red-800 font-medium"
                  >
                    Delete
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>